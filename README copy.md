# Futbol Frenzy API Server

The project is generated by [LoopBack](https://loopback.io).

## Command Reference

| Command                         | Result                                                                           |
|---------------------------------|----------------------------------------------------------------------------------|
| `npm start`                     | Run the server                                                                   |
| `npm run lint`                  | Run eslint to check for simple code mistakes                                     |
| `npm run db:install`            | Initializes all database tables to the latest schema. All data will be lost.     |
| `npm run import-rosters`        | Populates the database with league, team, and player data from the Stats.com API |
| `npm run update-event-schedule` | Populates the database with recent and upcoming match data.                      |
| `npm run update-standings`      | Updates team data with the latest standings.                                     |
| `npm run dev`                   | Run the server and automatically restart on code changes                         |
| `npm run dev:debug`             | Run the dev server in debug mode                                                 |
| `npm run test`                  | Run the test suite                                                               |
| `npm run test:debug`            | Run the test suite in debug mode                                                 |
| `npm run test:unit`             | Run the unit test suite.                                                         |
| `npm run docker:shell`          | Access bash on the app Docker instance. Because you don't need this until you do.|
| `npm run docker [command]`      | Runs any npm script using docker-compose, e.g. `npm run docker dev:debug`        |

## Development

1. You will need NPM and [Docker](https://www.docker.com) installed. Docker will take care of all remaining local dependencies, such as the database.
2. Configure your .env file (see "Service Dependencies" below)
3. With Docker running, you will need to run `npm run docker db:install` once to initialize the database.
4. Run `npm run docker dev` to bring up the development server.

### Debugging

You can run the app in debug mode using `npm run docker dev:debug`. Docker will bind the default node debug port of 9229 to `localhost:9229`. You may then connect to the debugger using your preferred tool, such as the Chrome Debugger (about:inspect) or VSCode. Debugging config for VSCode is included with the project.

To debug the database, you can either connect to `localhost:5432` with your preferred application, such as PgAdmin4 or Postico, or use the built-in instance of Adminer, a web-based database GUI. With the dev server running, Adminer can be accessed at http://localhost:8081.

## Service Dependencies

The application itself requires the following services:
 - PostgreSQL: Configured using `server/datasources.json`. See the [Loopback docs](https://loopback.io/doc/en/lb3/Environment-specific-configuration.html) for details.
 - Braintree Sandbox Server (remote): Copy `.env.example` to a new file `.env` and insert the Braintree credentials and configuration, or use environment variables.
 - Stats.com API: Copy `.env.example` to a new file `.env` and insert the Stats.com API credentials, or use environment variables.

## API Documentation

Run the server, then browse the REST API docs at http://localhost:3000/explorer.
